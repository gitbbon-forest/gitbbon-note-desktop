# 동기화 정책 개선 - 종합 테스트 시나리오

## 개요
`feature/sync-policy-improvement` 브랜치의 동기화 정책 개선에 대한 전체 테스트 시나리오입니다.

---

## 핵심 기능 테스트

### 1. 원격 저장소 404 감지

- [x] **준비**: 프로젝트 A를 생성하고 GitHub에 동기화한 후, GitHub 웹사이트에서 해당 원격 저장소를 수동으로 삭제합니다.
- [x] **테스트**: Gitbbon에서 동기화 버튼을 클릭합니다.
- [x] **예상 결과 (syncedAt 있음)**: 로컬 프로젝트가 자동으로 휴지통으로 이동됩니다.
- [x] **예상 결과 (syncedAt 없음)**: 새 원격 저장소가 자동으로 생성됩니다.
- [x] **검증**: 다이얼로그 없이 자동으로 처리되는지 확인합니다.

### 2. 새 머신 시나리오 (로컬 수정 없음)

- [x] **준비**:
  - 머신 A: `default` 프로젝트 생성 및 동기화 (GitHub에 `gitbbon-note-default` 생성됨)
  - 머신 B: Gitbbon 최초 실행 (로컬에 `default` 폴더 자동으로 생성됨)
- [x] **테스트**: 머신 B에서 수정 없이 즉시 동기화 버튼을 클릭합니다.
- [x] **예상 결과**: 별도의 대화상자 없이 자동으로 원격의 내용이 로컬로 덮어씌워집니다.
- [x] **검증**: 파일 내용이 머신 A와 일치하는지 확인합니다.
- [x] **검증**: manifest의 `lastModified`가 업데이트되는지 확인합니다.

### 3. 새 머신 시나리오 (로컬 수정 있음)

- [x] **준비**:
  - 머신 A: `default` 프로젝트 생성 및 동기화
  - 머신 B: 최초 실행 후, `README.md`를 수정하고 저장합니다 (자동 저장 트리거).
- [ ] **테스트**: 머신 B에서 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 이름 충돌에 대한 옵션이 포함된 경고 다이얼로그가 표시됩니다.
- [ ] **검증 - 원격 내용으로 덮어쓰기**: 로컬 수정사항이 사라지고 원격의 내용과 일치하게 되는지 확인합니다.
- [ ] **검증 - 다른 이름으로 생성**: 새 저장소 `gitbbon-note-default-1`이 생성되고 push되는지 확인합니다.
- [ ] **검증 - 취소**: 아무런 변경이 일어나지 않는지 확인합니다.

### 4. 일반 동기화 (회귀 테스트)

- [ ] **준비**: 프로젝트가 생성되고 성공적으로 동기화된 상태입니다.
- [ ] **테스트**: 파일을 수정하고 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: Pull → Push가 정상적으로 작동합니다.
- [ ] **검증**: 변경사항이 원격에 반영되었는지 확인합니다.
- [ ] **검증**: 콘솔 로그에 오류가 없는지 확인합니다.

### 5. 병합 충돌 감지

- [ ] **준비**:
  - 머신 A와 B가 동일한 프로젝트를 동기화한 상태입니다.
  - 머신 A: 파일을 수정하고 동기화합니다.
  - 머신 B: (Pull 하지 않은 상태에서) 동일한 파일을 수정하고 동기화를 시도합니다.
- [ ] **테스트**: 머신 B에서 동기화를 클릭합니다.
- [ ] **예상 결과**: 충돌 경고가 표시됩니다.
- [ ] **검증**: Push가 중단되는지 확인합니다.
- [ ] **검증**: 로컬 파일 상태가 보존되는지 확인합니다.

---

## 네트워크 및 인증 테스트

### 6. 네트워크 오프라인 시나리오

- [ ] **준비**: 원격이 설정된 프로젝트입니다.
- [ ] **테스트**: 네트워크 연결을 끊고 동기화를 클릭합니다.
- [ ] **예상 결과 (자동 모드)**: 조용히 동기화가 건너뛰어집니다.
- [ ] **예상 결과 (수동 모드)**: 오류 알림이 표시됩니다.
- [ ] **검증**: 데이터 손상이 없는지 확인합니다.
- [ ] **검증**: 네트워크 복구 후 동기화가 정상 작동하는지 확인합니다.

### 7. GitHub 인증 만료

- [ ] **준비**: 설정에서 GitHub 토큰을 취소합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 재인증 프롬프트가 표시됩니다.
- [ ] **검증**: 재인증 후 동기화가 정상적으로 진행되는지 확인합니다.

### 8. GitHub API 속도 제한 (Rate Limit)

- [ ] **준비**: API 호출을 대량으로 발생시켜 속도 제한을 유도합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 적절한 오류 메시지가 표시됩니다.
- [ ] **검증**: 대기 시간 이후 재시도했을 때 정상 작동하는지 확인합니다.

### 9. GitHub 권한 부족 (403)

- [ ] **준비**: `repo` 스코프가 없는 토큰을 사용합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 권한 오류 메시지가 표시됩니다.
- [ ] **검증**: 권한 수정 방법 안내가 표시되는지 확인합니다.

---

## 저장소 상태 테스트

### 10. 빈 저장소 (커밋 없음)

- [ ] **준비**: 새 프로젝트를 생성하고 커밋을 하나도 하지 않습니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 초기 커밋이 자동으로 생성됩니다.
- [ ] **검증**: 초기 커밋이 포함된 원격 저장소가 생성되는지 확인합니다.

### 11. 관련 없는 히스토리 (Unrelated Histories)

- [ ] **준비**:
  - 머신 A: 프로젝트 생성 및 동기화
  - 머신 B: 동일한 이름의 프로젝트를 개별적으로 생성하고 동기화 시도
- [ ] **테스트**: 동기화를 시도합니다.
- [ ] **예상 결과**: 관련 없는 히스토리 오류 또는 자동 해결 로직이 작동합니다.
- [ ] **검증**: 데이터 손실이 없는지 확인합니다.

### 12. 강제 푸시(Force Push) 감지

- [ ] **준비**:
  - 머신 A: 프로젝트 동기화
  - 머신 B: 동일한 원격에 강제 푸시를 수행합니다.
  - 머신 A: 동기화 시도
- [ ] **테스트**: 머신 A에서 동기화를 클릭합니다.
- [ ] **예상 결과**: 강제 푸시 감지에 대한 경고가 표시됩니다.
- [ ] **검증**: 사용자가 Pull 하거나 중단할 수 있는지 확인합니다.

### 13. 원격 브랜치 이름 변경

- [ ] **준비**: GitHub에서 `main` 브랜치 이름을 `master`로 변경합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 브랜치를 찾을 수 없다는 오류가 발생합니다.
- [ ] **검증**: 해결을 위한 명확한 안내가 표시되는지 확인합니다.

### 14. 대용량 파일 푸시

- [ ] **준비**: 100MB가 넘는 파일을 프로젝트에 추가합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: GitHub 대용량 파일 경고가 발생합니다.
- [ ] **검증**: 유용한 메시지와 함께 동기화가 안전하게 실패하는지 확인합니다.

---

## 다중 프로젝트 테스트

### 15. 여러 프로젝트 동기화

- [ ] **준비**: 3개의 프로젝트(A, B, C)를 생성합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 모든 프로젝트가 순차적으로 동기화됩니다.
- [ ] **검증**: 일부 실패하더라도 다른 프로젝트에 영향을 주지 않는지 확인합니다.
- [ ] **검증**: 각 프로젝트의 상태가 명확히 표시되는지 확인합니다.

### 16. 동기화 중 프로젝트 삭제

- [ ] **준비**: 동기화를 시작하고 도중에 프로젝트 폴더를 삭제합니다.
- [ ] **테스트**: 동작을 관찰합니다.
- [ ] **예상 결과**: 우아한 에러 처리가 이루어집니다.
- [ ] **검증**: 크래시 없이 명확한 에러 메시지가 표시되는지 확인합니다.

---

## 다운 싱크 (발견) 테스트

### 17. 새 원격 저장소 발견

- [ ] **준비**: GitHub에 수동으로 `gitbbon-note-newproject`를 생성합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 새 프로젝트가 로컬로 자동 클론됩니다.
- [ ] **검증**: 프로젝트 스위처에 프로젝트가 나타나는지 확인합니다.
- [ ] **검증**: 파일이 원격과 일치하는지 확인합니다.

### 18. 원격 저장소 이름 불일치

- [ ] **준비**: GitHub에서 원격 저장소 이름을 변경합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 오류 또는 이름 변경 감지 로직이 작동합니다.
- [ ] **검증**: 사용자가 다시 연결하거나 무시할 수 있는지 확인합니다.

---

## 엣지 케이스

### 19. 손상된 로컬 Git 저장소

- [ ] **준비**: `.git/config` 파일을 삭제합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 오류가 감지되고 복구 옵션이 제공됩니다.
- [ ] **검증**: 재초기화하거나 프로젝트를 삭제할 수 있는지 확인합니다.

### 20. 여러 머신에서의 동시 동기화

- [ ] **준비**: 머신 A와 B에서 동시에 동기화 버튼을 클릭합니다.
- [ ] **테스트**: 동작을 관찰합니다.
- [ ] **예상 결과**: 하나는 성공하고 다른 하나는 충돌이 발생합니다.
- [ ] **검증**: 데이터 손상이 없는지 확인합니다.

### 21. 매우 긴 커밋 히스토리

- [ ] **준비**: 1000개 이상의 커밋이 있는 프로젝트입니다.
- [ ] **테스트**: 새 머신에서 클론하고 동기화합니다.
- [ ] **예상 결과**: 동기화가 완료됩니다 (다소 느릴 수 있음).
- [ ] **검증**: 모든 히스토리가 보존되는지 확인합니다.

### 22. 파일 이름의 특수 문자

- [ ] **준비**: 이모지, 유니코드, 공백이 포함된 파일을 생성합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 모든 파일이 올바르게 동기화됩니다.
- [ ] **검증**: 파일 이름이 정확하게 유지되는지 확인합니다.

### 23. 서브모듈 또는 중첩된 Git 저장소

- [ ] **준비**: 프로젝트에 git 서브모듈을 추가합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 알림 또는 자동 처리 로직이 작동합니다.
- [ ] **검증**: 손상이 없는지 확인합니다.

### 24. 정기 자동 동기화 (30분)

- [ ] **준비**: Gitbbon을 켜둔 상태로 유지합니다.
- [ ] **테스트**: 30분 동안 대기합니다.
- [ ] **예상 결과**: 자동 모드(silent)로 동기화가 트리거됩니다.
- [ ] **검증**: 사용자 방해가 없는지 확인합니다.
- [ ] **검증**: 로그에 동기화 활동이 기록되는지 확인합니다.

### 25. 편집 중 동기화

- [ ] **준비**: 에디터에서 파일을 열고 타이핑을 시작합니다.
- [ ] **테스트**: 타이핑 도중에 동기화를 클릭합니다.
- [ ] **예상 결과**: 동기화가 대기하거나 저장되지 않은 변경사항에 대해 경고합니다.
- [ ] **검증**: 데이터 손실이 없는지 확인합니다.

---

## 성능 테스트

### 26. 대용량 저장소 (100개 이상의 파일)

- [ ] **준비**: 100개 이상의 마크다운 파일이 있는 프로젝트입니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 합리적인 시간 내에 동기화가 완료됩니다.
- [ ] **검증**: 진행 표시가 나타나는지 확인합니다.

### 27. 느린 네트워크 연결

- [ ] **준비**: 네트워크 속도를 100kbps로 제한합니다.
- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **예상 결과**: 동기화가 완료됩니다 (느리게).
- [ ] **검증**: 타임아웃 처리가 작동하는지 확인합니다.
- [ ] **검증**: 필요한 경우 취소할 수 있는지 확인합니다.

---

## UI/UX 테스트

### 28. 동기화 상태 표시

- [ ] **테스트**: 동기화 버튼을 클릭합니다.
- [ ] **검증**: 상태 바에 "Syncing..."이 표시되는지 확인합니다.
- [ ] **검증**: 완료 메시지가 나타나는지 확인합니다.
- [ ] **검증**: Git 그래프가 자동으로 새로고침되는지 확인합니다.

### 29. 오류 메시지의 명확성

- [ ] **테스트**: 다양한 오류를 유도합니다.
- [ ] **검증**: 모든 에러 메시지가 명확하고 조치 가능한지 확인합니다.
- [ ] **검증**: 설명 없는 전문 용어가 과도하게 사용되지 않았는지 확인합니다.

### 30. 다이얼로그 버튼 순서

- [ ] **테스트**: 모든 경고 다이얼로그를 열어봅니다.
- [ ] **검증**: 파괴적인 액션(삭제 등)이 기본값으로 설정되지 않았는지 확인합니다.
- [ ] **검증**: 안전한 액션(취소, 무시)에 쉽게 접근할 수 있는지 확인합니다.

---

## 추가 개선 사항

### UI 지역화
- [ ] 모든 한국어 UI 문자열을 영어로 변경 (코드 내부적으로)
  - [ ] `'로컬도 삭제'` → `'Delete Local'`
  - [ ] `'새 원격 생성'` → `'Create New Remote'`
  - [ ] `'무시'` → `'Ignore'`
  - [ ] `'원격 내용으로 덮어쓰기'` → `'Overwrite with Remote'`
  - [ ] `'다른 이름으로 생성'` → `'Create with Different Name'`
  - [ ] `'취소'` → `'Cancel'`

### AI 어시스턴트 통합
- [ ] 모든 경고 다이얼로그에 "AI에게 물어보기" 버튼 추가
- [ ] 클릭 시 현재 상황에 대한 문맥과 함께 채팅 패널 열기
- [ ] 결정을 내리기 전에 사용자가 AI와 상황을 논의할 수 있도록 지원

---

## 참고 사항
- `npm run start`에서 종료 코드 130이 발생하는 것은 예상된 결과입니다 (사용자가 Ctrl+C로 종료).
- 로그에 따르면 정기 동기화(30분)가 올바르게 작동하고 있습니다.
- 초기 검증을 위해 1-5번 시나리오에 집중하세요.
- 6-30번 시나리오는 철저한 테스트를 위한 포괄적인 엣지 케이스입니다.
